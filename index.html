<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes Taking App</title>
</head>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">

<body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo03"
                aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand" href="#">Note Taking Application</a>
            <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#">Home</a>
                    </li>
                    <!-- <li class="nav-item">
                        <a class="nav-link" href="#">Link</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
                    </li> -->
                </ul>
                <form class="d-flex">
                    <input class="form-control me-2" id="searchtext" type="search" placeholder="Search"
                        aria-label="Search">
                    <button class="btn btn-outline-success" type="submit">Search</button>
                </form>
            </div>
        </div>
    </nav>

    <div class="container my-3">
        <h2>Welcome to Notes Taking App</h2>

        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Add a Note</h5>
                <div class="mb-3">
                    <input type="text" class="form-control" id="notetitle" placeholder="Enter your Note Title">
                </div>
                <div class="mb-3">
                    <textarea class="form-control" id="addtext" rows="3" placeholder="Enter your Note"></textarea>
                </div>
                <button class="btn btn-primary" id="savebtn">Save Note</button>
            </div>
        </div>

        <h2 class="my-3">Your Notes</h2>

        <div class="container-fluid row" id="notes">
        </div>

    </div>



</body>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
    integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-lpyLfhYuitXl2zRZ5Bn2fqnhNAKOAaM/0Kr9laMspuaMiZfGmfwRNFh8HlMy49eQ"
    crossorigin="anonymous"></script>


<script>

    let notetitle = localStorage.getItem("notetitle");
    let notetext = localStorage.getItem("notetext");
    if (notetitle == null)
        notetext = [], notetitle = [];
    else
        notetext = JSON.parse(notetext), notetitle = JSON.parse(notetitle);

    displaynotes();

    let savebtn = document.getElementById('savebtn');
    savebtn.addEventListener('click', () => {

        let text = document.getElementById('addtext');
        let title = document.getElementById('notetitle');

        if (title.value == "")
            return;

        notetitle.push(title.value);
        notetext.push(text.value);
        title.value = text.value = "";

        localStorage.clear();
        localStorage.setItem('notetitle', JSON.stringify(notetitle));
        localStorage.setItem('notetext', JSON.stringify(notetext));

        displaynotes();
    });

    function displaynotes() {

        notetitle = localStorage.getItem("notetitle");
        notetext = localStorage.getItem("notetext");
        if (notetitle == null)
            notetext = [], notetitle = [];
        else
            notetext = JSON.parse(notetext), notetitle = JSON.parse(notetitle);

        let html = "";
        notetext.forEach((element, index) => {
            html += `<div class="card my-2 mx-2" style="width: 18rem;">
        <div class="card-body">
          <h5 class="card-title">${notetitle[index]}</h5>
          <p class="card-text">${element}</p>
          <a href="#" id="${index}" onclick = "deletenote(this.id)" class="btn btn-primary">Delete Note</a>
        </div>
      </div>`
        });

        if (html == "")
            html = 'No notes added. Add notes using "Add a Note section"';

        document.getElementById('notes').innerHTML = html;
    }

    function deletenote(index) {

        notetitle = localStorage.getItem("notetitle");
        notetext = localStorage.getItem("notetext");
        if (notetitle == null)
            notetext = [], notetitle = [];
        else
            notetext = JSON.parse(notetext), notetitle = JSON.parse(notetitle);

        notetitle.splice(index, 1);
        notetext.splice(index, 1);

        localStorage.clear();
        localStorage.setItem('notetitle', JSON.stringify(notetitle));
        localStorage.setItem('notetext', JSON.stringify(notetext));

        displaynotes();
    }

    let search = document.getElementById('searchtext');

    search.addEventListener('input', () => {

        let searchval = search.value.toLowerCase();
        // console.log(searchval);

    
        notetitle = localStorage.getItem("notetitle");
        notetext = localStorage.getItem("notetext");
        if (notetitle == null)
            notetext = [], notetitle = [];
        else
            notetext = JSON.parse(notetext), notetitle = JSON.parse(notetitle);

        let html = "";

        notetext.forEach((element, index) => {
            
            if (notetitle[index].toLowerCase().includes(searchval) || element.toLowerCase().includes(searchval)) {
                
                html += `<div class="card my-2 mx-2" style="width: 18rem;">
            <div class="card-body">
            <h5 class="card-title">${notetitle[index]}</h5>
            <p class="card-text">${element}</p>
            <a href="#" id="${index}" onclick = "deletenote(this.id)" class="btn btn-primary">Delete Note</a>
            </div>
            </div>`;
            }
        });

        if (html == "")
            html = `${search.value} doesn't exist`;

        document.getElementById('notes').innerHTML = html;
    });


</script>

</html>